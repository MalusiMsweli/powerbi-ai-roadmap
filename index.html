<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive AI Integration Roadmap for Power BI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Harmony -->
    <!-- Application Structure Plan: A tab-based or "stepper" single-page application. The user starts with an overview and can click through distinct phases (Infrastructure, Interface, Advanced Capabilities), a consolidated roadmap table, and a resources section. This structure breaks down the complex report into manageable, logical chunks, preventing information overload and guiding the user through the learning journey. It prioritizes clarity and focused exploration over a long, linear scroll. -->
    <!-- Visualization & Content Choices: The report's content is primarily conceptual and procedural. Therefore, visualizations focus on clarifying structure and process. The core architecture is represented by an interactive HTML/CSS diagram. Key comparisons (like LLM platforms) are presented in enhanced tables. Complex workflows (like DAX generation) are simplified into visual step-by-step flows using HTML/CSS. All choices avoid SVG/Mermaid and use structured HTML and Tailwind CSS to create clear, interactive, and informative visual elements that support the user's understanding of the technical roadmap. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .nav-link {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .nav-link.active {
            color: #0d9488; /* teal-600 */
            border-bottom-color: #0d9488; /* teal-600 */
        }
        .content-section {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        .content-section.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .step-connector {
            flex-grow: 1;
            height: 2px;
            background-color: #cbd5e1; /* slate-300 */
        }
        .step-item.active .step-circle {
            background-color: #0d9488; /* teal-600 */
            border-color: #0d9488; /* teal-600 */
            color: white;
        }
        .step-item.active .step-label {
            color: #0d9488; /* teal-600 */
            font-weight: 600;
        }
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 220px;
            background-color: #1e293b; /* slate-800 */
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -110px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body class="text-slate-700">

    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-slate-800 mb-2">AI Integration Roadmap for Power BI</h1>
            <p class="text-lg text-slate-600">An interactive guide to building a custom, budget-friendly conversational AI.</p>
        </header>

        <nav class="sticky top-0 bg-slate-50/80 backdrop-blur-sm z-10 mb-8 border-b border-slate-200">
            <div class="flex justify-center space-x-4 sm:space-x-8 text-sm sm:text-base font-medium text-slate-600">
                <a class="nav-link py-4 border-b-2 border-transparent hover:text-teal-600" data-target="home">Overview</a>
                <a class="nav-link py-4 border-b-2 border-transparent hover:text-teal-600" data-target="phase1">Phase 1</a>
                <a class="nav-link py-4 border-b-2 border-transparent hover:text-teal-600" data-target="phase2">Phase 2</a>
                <a class="nav-link py-4 border-b-2 border-transparent hover:text-teal-600" data-target="phase3">Phase 3</a>
                <a class="nav-link py-4 border-b-2 border-transparent hover:text-teal-600" data-target="dax-generator">DAX Generator âœ¨</a>
                <a class="nav-link py-4 border-b-2 border-transparent hover:text-teal-600" data-target="roadmap">Roadmap</a>
                <a class="nav-link py-4 border-b-2 border-transparent hover:text-teal-600" data-target="resources">Resources</a>
            </div>
        </nav>

        <main id="main-content">
            <!-- Overview Section -->
            <section id="home" class="content-section">
                <h2 class="text-3xl font-bold text-slate-800 mb-4">Executive Summary: The AI Integration Blueprint</h2>
                <div class="space-y-4 text-slate-600 leading-relaxed">
                    <p>The integration of artificial intelligence (AI) and business intelligence (BI) platforms like Power BI is a strategic imperative for organizations seeking to derive deeper, more immediate value from their data. This interactive guide outlines a detailed, phased roadmap for a beginner to create a custom, budget-friendly AI integration within Power BI. The central thesis is that a sophisticated, conversational BI experience can be built using a stack of open-source and native Microsoft technologies, circumventing the high costs associated with commercial AI services and premium licenses.</p>
                    <p>The proposed solution is a three-phased blueprint. Click through the phases above to explore the journey from establishing the core infrastructure to implementing advanced capabilities like AI-generated DAX and visuals. This guide translates a complex, multi-domain technical challenge into a clear, actionable plan.</p>
                </div>
            </section>

            <!-- Phase 1 Section -->
            <section id="phase1" class="content-section">
                <h2 class="text-3xl font-bold text-slate-800 mb-2">Phase 1: Establishing the Core Infrastructure</h2>
                <p class="text-lg text-slate-600 mb-8">This initial phase is about laying the foundation. Here, we'll select and host a local, open-source AI model and then build the communication channel that allows it to talk to Power BI. This ensures a private, secure, and cost-effective AI backend.</p>

                <div class="space-y-12">
                    <div>
                        <h3 class="text-2xl font-semibold text-slate-800 mb-4">Conceptual Architecture</h3>
                        <p class="mb-6 text-slate-600">The solution is built on three interconnected layers. The diagram below shows how the User Interface in Power BI communicates through an Integration Layer to the AI Backend, creating a seamless conversational loop.</p>
                        <div class="bg-white p-6 rounded-lg shadow-md border border-slate-200">
                            <div class="flex flex-col md:flex-row items-center justify-between space-y-4 md:space-y-0 md:space-x-4 text-center">
                                <div class="tooltip w-full md:w-1/3 p-4 bg-teal-50 rounded-lg border border-teal-200">
                                    <h4 class="font-bold text-teal-800">Power BI Front-End</h4>
                                    <p class="text-sm text-teal-700">Custom Chat Visual</p>
                                    <span class="tooltiptext">The user-facing component where you type prompts and see results. It orchestrates the entire process.</span>
                                </div>
                                <div class="text-2xl text-slate-400 font-mono">&lt;--&gt;</div>
                                <div class="tooltip w-full md:w-1/3 p-4 bg-indigo-50 rounded-lg border border-indigo-200">
                                    <h4 class="font-bold text-indigo-800">Integration Layer</h4>
                                    <p class="text-sm text-indigo-700">Custom Power Query Connector</p>
                                    <span class="tooltiptext">The communication bridge that sends requests to the AI and retrieves responses in a structured format.</span>
                                </div>
                                <div class="text-2xl text-slate-400 font-mono">&lt;--&gt;</div>
                                <div class="tooltip w-full md:w-1/3 p-4 bg-rose-50 rounded-lg border border-rose-200">
                                    <h4 class="font-bold text-rose-800">AI Backend</h4>
                                    <p class="text-sm text-rose-700">Local LLM (Ollama)</p>
                                    <span class="tooltiptext">The core intelligence. A locally hosted, open-source model that processes language and generates answers securely on your machine.</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-2xl font-semibold text-slate-800 mb-4">Choosing a Local AI Model</h3>
                        <p class="mb-6 text-slate-600">To stay on budget, we'll use a free, open-source Large Language Model (LLM) that you can run on your own computer. This avoids costly API fees. The key is choosing a platform that balances ease of use with performance for your hardware.</p>
                         <div class="overflow-x-auto bg-white rounded-lg shadow-md border border-slate-200">
                            <table class="w-full text-left">
                                <thead class="bg-slate-100">
                                    <tr>
                                        <th class="p-4 font-semibold text-slate-700">Platform</th>
                                        <th class="p-4 font-semibold text-slate-700">Key Features</th>
                                        <th class="p-4 font-semibold text-slate-700">Ideal Use Case</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-slate-200">
                                    <tr class="hover:bg-slate-50">
                                        <td class="p-4 font-medium text-slate-800">Ollama (Recommended)</td>
                                        <td class="p-4 text-slate-600">Streamlined REST API, simple command-line interface, wide model support.</td>
                                        <td class="p-4 text-slate-600">Best for developers needing easy programmatic integration.</td>
                                    </tr>
                                    <tr class="hover:bg-slate-50">
                                        <td class="p-4 text-slate-600">GPT4All</td>
                                        <td class="p-4 text-slate-600">Privacy-first desktop client, can chat with local documents.</td>
                                        <td class="p-4 text-slate-600">Privacy-conscious users and document-based queries.</td>
                                    </tr>
                                    <tr class="hover:bg-slate-50">
                                        <td class="p-4 text-slate-600">LM Studio</td>
                                        <td class="p-4 text-slate-600">User-friendly GUI, OpenAI-compatible API for easy integration.</td>
                                        <td class="p-4 text-slate-600">Users who prefer a graphical interface for managing models.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Phase 2 Section -->
            <section id="phase2" class="content-section">
                <h2 class="text-3xl font-bold text-slate-800 mb-2">Phase 2: Building the Conversational Interface</h2>
                <p class="text-lg text-slate-600 mb-8">With the backend ready, this phase focuses on the user experience. We will create a way for the AI to understand your data model and build a custom chat interface right inside your Power BI report.</p>
                <div class="space-y-12">
                    <div>
                        <h3 class="text-2xl font-semibold text-slate-800 mb-4">Unlocking the Semantic Model with TMDL</h3>
                        <p class="mb-6 text-slate-600">For the AI to give relevant answers, it needs to know your data's structure (tables, columns, etc.). The new Tabular Model Definition Language (TMDL) is the key. It exports your entire model schema into a human-readable text file that our AI can easily read and understand, without needing an expensive Premium license.</p>
                        <div class="bg-white p-6 rounded-lg shadow-md border border-slate-200 flex items-center space-x-6">
                            <div class="flex-shrink-0">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-teal-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                </svg>
                            </div>
                            <div>
                                <h4 class="text-xl font-bold text-slate-800">From Model to Text</h4>
                                <p class="text-slate-600">By enabling the TMDL preview feature in Power BI, you can script your entire semantic model into text files. This provides the programmatic blueprint of your data structure, giving the AI the context it needs to generate accurate, data-aware responses.</p>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-2xl font-semibold text-slate-800 mb-4">Crafting the Custom Chat Visual</h3>
                        <p class="mb-6 text-slate-600">A standard Power BI text box can't trigger our AI. We need to build a custom visual that acts as an interactive chat interface. This visual is the central "orchestrator" that connects all the pieces.</p>
                         <div class="bg-white p-6 rounded-lg shadow-md border border-slate-200">
                            <h4 class="text-xl font-bold text-slate-800 mb-4">Visual's Workflow:</h4>
                            <ol class="relative border-l border-slate-200 space-y-6">
                                <li class="ml-6">
                                    <span class="absolute flex items-center justify-center w-6 h-6 bg-teal-100 rounded-full -left-3 ring-8 ring-white">1</span>
                                    <h5 class="font-semibold text-slate-700">Capture Prompt</h5>
                                    <p class="text-sm text-slate-600">The user types a question into the visual's text field.</p>
                                </li>
                                <li class="ml-6">
                                    <span class="absolute flex items-center justify-center w-6 h-6 bg-teal-100 rounded-full -left-3 ring-8 ring-white">2</span>
                                    <h5 class="font-semibold text-slate-700">Add Context</h5>
                                    <p class="text-sm text-slate-600">The visual's code reads the TMDL schema to understand the data model.</p>
                                </li>
                                <li class="ml-6">
                                    <span class="absolute flex items-center justify-center w-6 h-6 bg-teal-100 rounded-full -left-3 ring-8 ring-white">3</span>
                                    <h5 class="font-semibold text-slate-700">Call AI</h5>
                                    <p class="text-sm text-slate-600">It sends the prompt and context to the local LLM via our custom connector.</p>
                                </li>
                                <li class="ml-6">
                                    <span class="absolute flex items-center justify-center w-6 h-6 bg-teal-100 rounded-full -left-3 ring-8 ring-white">4</span>
                                    <h5 class="font-semibold text-slate-700">Display Response</h5>
                                    <p class="text-sm text-slate-600">It receives the AI's answer and renders it in the chat interface.</p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Phase 3 Section -->
            <section id="phase3" class="content-section">
                <h2 class="text-3xl font-bold text-slate-800 mb-2">Phase 3: Implementing Advanced AI Capabilities</h2>
                <p class="text-lg text-slate-600 mb-8">This is where the magic happens. Building on our foundation, we'll explore how to empower the AI to not just answer questions, but to actively help build your report by generating DAX formulas and even creating visuals on command.</p>

                <div class="space-y-12">
                    <div>
                        <h3 class="text-2xl font-semibold text-slate-800 mb-4">Path to AI-Generated DAX</h3>
                        <p class="mb-6 text-slate-600">Getting the AI to write DAX is a two-step process. First, the AI generates the formula as a text string. Second, we need an external tool to inject that formula into the Power BI model, as the AI cannot modify the report directly.</p>
                        <div class="flex items-center space-x-4 text-center">
                            <div class="step-item active flex-1">
                                <div class="step-circle mx-auto w-12 h-12 rounded-full border-2 border-slate-300 flex items-center justify-center text-xl font-bold bg-white">1</div>
                                <div class="step-label mt-2 font-medium text-slate-600">AI Generates DAX String</div>
                            </div>
                            <div class="step-connector"></div>
                            <div class="step-item flex-1">
                                <div class="step-circle mx-auto w-12 h-12 rounded-full border-2 border-slate-300 flex items-center justify-center text-xl font-bold bg-white">2</div>
                                <div class="step-label mt-2 font-medium text-slate-600">External Tool (Tabular Editor) Applies DAX to Model</div>
                            </div>
                        </div>
                        <p class="mt-6 text-sm text-slate-500 text-center">This process requires an external scripting layer to bridge the gap between the AI's text output and the live data model.</p>
                    </div>

                    <div>
                        <h3 class="text-2xl font-semibold text-slate-800 mb-4">Pioneering AI-Driven Visual Creation</h3>
                        <p class="mb-6 text-slate-600">The ultimate goal is to have the AI create visuals. This requires the AI to output a structured description of the chart (e.g., in JSON format), which our custom visual can then parse and render dynamically.</p>
                         <div class="flex items-center space-x-4 text-center">
                            <div class="step-item active flex-1">
                                <div class="step-circle mx-auto w-12 h-12 rounded-full border-2 border-slate-300 flex items-center justify-center text-xl font-bold bg-white">1</div>
                                <div class="step-label mt-2 font-medium text-slate-600">AI Generates Visual JSON</div>
                            </div>
                            <div class="step-connector"></div>
                            <div class="step-item flex-1">
                                <div class="step-circle mx-auto w-12 h-12 rounded-full border-2 border-slate-300 flex items-center justify-center text-xl font-bold bg-white">2</div>
                                <div class="step-label mt-2 font-medium text-slate-600">Custom Visual Parses JSON</div>
                            </div>
                             <div class="step-connector"></div>
                            <div class="step-item flex-1">
                                <div class="step-circle mx-auto w-12 h-12 rounded-full border-2 border-slate-300 flex items-center justify-center text-xl font-bold bg-white">3</div>
                                <div class="step-label mt-2 font-medium text-slate-600">Visual Renders Chart (e.g., with D3.js)</div>
                            </div>
                        </div>
                        <p class="mt-6 text-sm text-slate-500 text-center">The challenge here is designing a robust communication protocol (the JSON schema) that the AI and the visual can both understand.</p>
                    </div>
                </div>
            </section>
            
            <!-- DAX Generator Section -->
            <section id="dax-generator" class="content-section">
                <h2 class="text-3xl font-bold text-slate-800 mb-2">DAX Formula Generator âœ¨</h2>
                <p class="text-lg text-slate-600 mb-8">This feature is a live demonstration of Phase 3. Simply describe the DAX formula you need in plain English, and a large language model will generate the code for you. You can then copy and paste it into Power BI.</p>

                <div class="bg-white p-6 rounded-lg shadow-md border border-slate-200">
                    <h3 class="text-2xl font-semibold text-slate-800 mb-4">Generate DAX</h3>
                    <p class="text-slate-600 mb-4">Enter your request below. For example: "Calculate the total sales for the last 12 months."</p>
                    <textarea id="dax-prompt-input" class="w-full h-24 p-4 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 text-slate-800" placeholder="Describe the DAX formula you need..."></textarea>
                    <button id="generate-dax-btn" class="mt-4 w-full sm:w-auto px-6 py-3 bg-teal-600 text-white font-bold rounded-lg shadow-md hover:bg-teal-700 transition-colors">
                        Generate DAX
                    </button>
                    <div id="dax-output-container" class="mt-6 hidden">
                        <h4 class="font-semibold text-slate-800 mb-2">Generated DAX:</h4>
                        <div class="relative bg-slate-800 p-4 rounded-lg overflow-x-auto">
                            <pre><code id="dax-output" class="text-sm text-teal-300"></code></pre>
                            <button id="copy-dax-btn" class="absolute top-2 right-2 px-3 py-1 bg-slate-700 text-white text-xs rounded-md hover:bg-slate-600 transition-colors">
                                Copy
                            </button>
                        </div>
                    </div>
                    <div id="loading-indicator" class="mt-6 hidden text-center text-slate-500">
                        <div class="animate-spin inline-block w-8 h-8 border-4 border-teal-500 border-t-transparent rounded-full"></div>
                        <p class="mt-2">Generating DAX...</p>
                    </div>
                    <div id="error-message" class="mt-6 hidden p-4 text-red-700 bg-red-100 rounded-lg">
                        An error occurred while generating the DAX. Please try again.
                    </div>
                </div>
            </section>

            <!-- Roadmap Table Section -->
            <section id="roadmap" class="content-section">
                <h2 class="text-3xl font-bold text-slate-800 mb-4">Consolidated AI Integration Roadmap</h2>
                <p class="mb-6 text-slate-600">Here is the entire project consolidated into a single, actionable table. Use this as your high-level checklist as you progress through the integration.</p>
                <div class="overflow-x-auto bg-white rounded-lg shadow-md border border-slate-200">
                    <table class="w-full text-left">
                        <thead class="bg-slate-100">
                            <tr>
                                <th class="p-4 font-semibold text-slate-700">Phase</th>
                                <th class="p-4 font-semibold text-slate-700">Objective</th>
                                <th class="p-4 font-semibold text-slate-700">Key Steps</th>
                                <th class="p-4 font-semibold text-slate-700">Tools/Technologies</th>
                                <th class="p-4 font-semibold text-slate-700">Expected Outcome</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-200">
                            <tr class="hover:bg-slate-50">
                                <td class="p-4 align-top font-medium bg-slate-50 text-slate-800">1: Infrastructure</td>
                                <td class="p-4 align-top">Select and Host the AI Model</td>
                                <td class="p-4 align-top text-sm">1. Choose a platform (Ollama recommended).<br>2. Install and download a lightweight LLM.</td>
                                <td class="p-4 align-top text-sm">Ollama, VS Code</td>
                                <td class="p-4 align-top text-sm">A local, working LLM with an accessible REST API.</td>
                            </tr>
                            <tr class="hover:bg-slate-50">
                                <td class="p-4 align-top font-medium bg-slate-50 text-slate-800"></td>
                                <td class="p-4 align-top">Build the Communication Gateway</td>
                                <td class="p-4 align-top text-sm">1. Set up Power Query SDK.<br>2. Develop a custom connector to call the API.<br>3. Package and install the `.mez` file.</td>
                                <td class="p-4 align-top text-sm">Power Query SDK, M Language</td>
                                <td class="p-4 align-top text-sm">A reusable, secure custom connector in Power BI.</td>
                            </tr>
                            <tr class="hover:bg-slate-50">
                                <td class="p-4 align-top font-medium bg-slate-50 text-slate-800">2: Interface</td>
                                <td class="p-4 align-top">Read the Semantic Model</td>
                                <td class="p-4 align-top text-sm">1. Enable TMDL View in Power BI.<br>2. Script the model to get the schema.</td>
                                <td class="p-4 align-top text-sm">Power BI Desktop, TMDL</td>
                                <td class="p-4 align-top text-sm">A programmatic blueprint of the model for AI context.</td>
                            </tr>
                            <tr class="hover:bg-slate-50">
                                <td class="p-4 align-top font-medium bg-slate-50 text-slate-800"></td>
                                <td class="p-4 align-top">Create the Chat Interface</td>
                                <td class="p-4 align-top text-sm">1. Set up Power BI visuals SDK.<br>2. Develop a custom visual with a text input.<br>3. Code the visual to orchestrate the AI call.</td>
                                <td class="p-4 align-top text-sm">Node.js, Power BI visuals SDK</td>
                                <td class="p-4 align-top text-sm">An interactive chat visual providing text-based answers.</td>
                            </tr>
                            <tr class="hover:bg-slate-50">
                                <td class="p-4 align-top font-medium bg-slate-50 text-slate-800">3: Advanced</td>
                                <td class="p-4 align-top">Generate DAX Formulas</td>
                                <td class="p-4 align-top text-sm">1. Prompt AI to generate a DAX string.<br>2. Create an external script to apply it to the model.</td>
                                <td class="p-4 align-top text-sm">Tabular Editor, C#</td>
                                <td class="p-4 align-top text-sm">A measure is created/updated via an external tool.</td>
                            </tr>
                             <tr class="hover:bg-slate-50">
                                <td class="p-4 align-top font-medium bg-slate-50 text-slate-800"></td>
                                <td class="p-4 align-top">Create Dynamic Visuals</td>
                                <td class="p-4 align-top text-sm">1. Prompt AI to generate a structured JSON.<br>2. Code the visual to parse JSON and render a chart.</td>
                                <td class="p-4 align-top text-sm">Power BI visuals SDK, D3.js</td>
                                <td class="p-4 align-top text-sm">An AI-generated chart appears on the report page.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Resources Section -->
            <section id="resources" class="content-section">
                <h2 class="text-3xl font-bold text-slate-800 mb-4">Essential Resources</h2>
                <p class="mb-6 text-slate-600">Here are the official documentation links and tools mentioned throughout the roadmap to help you get started on your development journey.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md border border-slate-200">
                        <h3 class="font-semibold text-slate-800 mb-2">Core Technologies</h3>
                        <ul class="space-y-2 list-disc list-inside text-teal-600">
                            <li><a href="https://ollama.com/" target="_blank" class="hover:underline">Ollama Documentation</a></li>
                            <li><a href="https://learn.microsoft.com/en-us/power-query/install-sdk" target="_blank" class="hover:underline">Power Query SDK</a></li>
                            <li><a href="https://learn.microsoft.com/en-us/power-bi/developer/visuals/visual-api" target="_blank" class="hover:underline">Power BI Visuals SDK</a></li>
                            <li><a href="https://learn.microsoft.com/en-us/analysis-services/tmdl/tmdl-overview?view=asallproducts-allversions" target="_blank" class="hover:underline">TMDL Documentation</a></li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md border border-slate-200">
                        <h3 class="font-semibold text-slate-800 mb-2">External Tools</h3>
                        <ul class="space-y-2 list-disc list-inside text-teal-600">
                            <li><a href="https://tabular.to/downloads" target="_blank" class="hover:underline">Tabular Editor</a></li>
                             <li><a href="https://www.daxformatter.com/" target="_blank" class="hover:underline">DAX Formatter</a></li>
                             <li><a href="https://d3js.org/" target="_blank" class="hover:underline">D3.js - Data-Driven Documents</a></li>
                        </ul>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const navLinks = document.querySelectorAll('.nav-link');
            const contentSections = document.querySelectorAll('.content-section');
            const mainContent = document.getElementById('main-content');
            const generateDaxBtn = document.getElementById('generate-dax-btn');
            const daxPromptInput = document.getElementById('dax-prompt-input');
            const daxOutputContainer = document.getElementById('dax-output-container');
            const daxOutput = document.getElementById('dax-output');
            const loadingIndicator = document.getElementById('loading-indicator');
            const errorMessage = document.getElementById('error-message');
            const copyDaxBtn = document.getElementById('copy-dax-btn');

            function showSection(targetId) {
                contentSections.forEach(section => {
                    if (section.id === targetId) {
                        section.classList.add('active');
                    } else {
                        section.classList.remove('active');
                    }
                });

                navLinks.forEach(link => {
                    if (link.dataset.target === targetId) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.dataset.target;
                    showSection(targetId);
                });
            });

            generateDaxBtn.addEventListener('click', async () => {
                const prompt = daxPromptInput.value.trim();
                if (!prompt) return;

                daxOutputContainer.classList.add('hidden');
                errorMessage.classList.add('hidden');
                loadingIndicator.classList.remove('hidden');

                const fullPrompt = `You are a helpful assistant that generates DAX code for Power BI. The user will provide a prompt, and you must respond ONLY with the DAX code. Do not include any explanations, greetings, or additional text. If you cannot generate the DAX, respond with "Error: Could not generate DAX." Here is the prompt: "${prompt}"`;
                
                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: fullPrompt }] });
                const payload = { contents: chatHistory };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                let retryCount = 0;
                const maxRetries = 5;
                let delay = 1000;

                while (retryCount < maxRetries) {
                    try {
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (response.status === 429) {
                            console.error(`Rate limit exceeded, retrying in ${delay}ms...`);
                            await new Promise(res => setTimeout(res, delay));
                            delay *= 2;
                            retryCount++;
                            continue;
                        }

                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }

                        const result = await response.json();
                        const generatedText = result.candidates?.[0]?.content?.parts?.[0]?.text;

                        if (generatedText) {
                            daxOutput.textContent = generatedText;
                            daxOutputContainer.classList.remove('hidden');
                        } else {
                            errorMessage.textContent = 'Error: No DAX code was generated. Please try again.';
                            errorMessage.classList.remove('hidden');
                        }
                        break;
                    } catch (error) {
                        console.error('Fetch error:', error);
                        errorMessage.textContent = 'An error occurred while generating the DAX. Please try again.';
                        errorMessage.classList.remove('hidden');
                        break;
                    } finally {
                        loadingIndicator.classList.add('hidden');
                    }
                }

                if (retryCount >= maxRetries) {
                    loadingIndicator.classList.add('hidden');
                    errorMessage.textContent = 'Failed to generate DAX after multiple retries. Please try again later.';
                    errorMessage.classList.remove('hidden');
                }
            });

            copyDaxBtn.addEventListener('click', () => {
                const daxCode = daxOutput.textContent;
                navigator.clipboard.writeText(daxCode).then(() => {
                    const originalText = copyDaxBtn.textContent;
                    copyDaxBtn.textContent = 'Copied!';
                    setTimeout(() => {
                        copyDaxBtn.textContent = originalText;
                    }, 2000);
                }).catch(err => {
                    console.error('Failed to copy text: ', err);
                });
            });

            // Show the home section by default
            showSection('home');
        });
    </script>
</body>
</html>
